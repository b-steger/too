;;;; TOO (The Offline Oriented) creates ZIM files with offline available maps
;;;; Copyright (C) 2022 Benedikt Steger <b.steger@protonmail.ch>
;;;; 
;;;; This program is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
;;;; 
;;;; This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more details.
;;;; 
;;;; You should have received a copy of the GNU Affero General Public License along with this program. If not, see <http://www.gnu.org/licenses/>.

(in-package :too)

;;;; Write the ZIM file

(defun uuid (flavour &optional render?)
  "An integer that represents the ID of a flavour. Encodes YEAR MONTH DAY ZOOM-MAX #'final-nickname from FLAVOUR."
  (let ((value (parse-integer (format nil "窿祜镳骘轭翦珏徙蝻篌礓岛礓刁蹴篝蜷铉ㄦ矧磲铋⒃栝轶韵骒狯秕鏖翳轰狒镰镰喉狲镲候彗轱廉遽骒狯秕颟盹铘骒狯秕颟ㄤ狴骒狯秕颟镲憝磲骒狯秕颟ㄦ轭犰铋汶钺礤骒狯秕颟┅泔祆邈ㄦ矧磲铋铂О丌轭翦珏颟┅候徜轼倍┅ㄩ蝈钿弪鏖翳秕麴豸麸篝蜷铉秕舂戾è篝蝈犴ㄦ戾榄篝蝈犴蠛磲脲轭礤盹蝙秕麴豸篝蝈犴┅黩轸瀛轭翦珏鲠祯倍篝蝈犴祜镳骘翳孱ㄩ钽椹骘怡翦徙蝻篌ㄦ戾榄篝蝈犴蠛珏舡秕麴豸篝蝈犴箦聃孱沐篝蝈犴麒孱ㄦ轭Ж卑┅滹ㄦ矧磲秕滹ㄦ矧磲秕铂О佝怡翦┅┅鲠祯濠┅换貂殇黠螂忮钽韬邯箦戾泗邃骒狯秕颡冤ㄤ彐躅泔铘孱趔产轫骈戾é脲轫泔铘孱趔轫屮犴痨濯骒狯秕秕舡骈戾溴霪箬懑翦篝轫礤翎糸戾溟颦忉箦鲠虔扉獐盹溥糸戾ㄣ镯痱弩箝镱戾鲥膊篝犷溽祜铄冤⒆蜷翦谏骈戾鏖翳谏铜孟卧盼杂翳秕麴豸镦＇轫泔铘孱趔犷轭篝犷沐镦噤轵┊涉孟托遗佑上苇膛峙轶铒瞽铋飕翳沆躞翦蝮鏖翳轭翳谏骈戾珏泔眇蝈篌邃鏖翳谟阅歪糸戾狎箫躜沐溟蝈泗禊骝镯翳礤翎糸戾轭翳磲糸戾溟蝈泗矧ㄩ釉廖牧滔闻轶铒瞽铋飑ㄧ屣礤趄铺林险药溴骈铄麒狒糸戾狎泔痖邃澡轶骢钽糸镱轶瞌铄沐篌狎殪扉黹翦麸韵惜躞汜箦婶轶痫篌殁戾麸戾狯铺林险屙痿物磲糸戾狎徜溴麸翳谏骈戾轭翳轶汜箦馏篚礤怜轭溴梏盱狍翳麇煦镯疳珏戾舄è沆躞翦颦痫轭翦颦扉篝ī痫箝糸镱痫轭翦蜢轶舡沆躞翦铋飑ㄤ轵孱趄痫轭翦颦扉篝ī痫箝糸镱痫轭翦蜢轶舡躜铋飑痫箝糸镱痫轭翦蜢轶舡糸綮铋飑痫箝糸镱汨邈塍蹴铋飑鏖翳镳孱骈戾ㄦ秕舡骈戾洪姝屮轶趔后躔弪箦溴洪姝滹弩铒舡屮轶恒蝈狒轰轵邈糸镱猴豸瘐哄戾礤铘豉疱Ж躅箝珙邃怡翦俯换昨轸漉眄桢徜弪黩轸瀛箦聃孱沐ㄨ遽溴颟姗换澡蜕团豉疱扉篝眭篝溟蝈泗禊骘祆秣翳桢徜弪黩轸瀛箦聃孱沐黹礤豉疱扉篝姗戾舄è孱趄殄ㄥ铛礤蜥翦沆躞翦颦忪镡蟆候屙衢铋铉溟颦孱趄殄痱屦孱洵黹礤栝篝镧蜥ㄡ痧孱ㄦ灬趑孱溟轫泔铘孱趔麒孱ㄡ钿骒狯秕篝犷溽祜铄咯ㄤ轵孱趄糸戾烘灬鲲躜骒狯秕喉弭狒殪瀛溟颦忉箦礤翎糸戾溟颦忉箦┅┅┅换昨轸翳沆躞翦泔铘孱趔换韵南疳蜥祆屐辁泔眇蝈篌轱町换澡蝈犰韵南轶Ⅲ弪獒扉疳蜥祆屐黠螂弪螈徙趱犰禊驷祆轭忉汶麸镱黠螂弪狒懋换领蝈徜礤狍躜徕戾轫痱秭屙孱轭溴邃换祓狎犰戾歆＇痦狃汜颥骘屮犴痨瀣轶麸礤盹蝙屮疱铙轹躅骘螋躅狒屐戾è沆躞翦蝮祜镳鏖翳怩汶弭磲脲栳箬翎忪濠骘孱趄轭孱趄殄麒孱豉疱孱趄т轵孱趄泔铘孱舂滹瘐箬孱趄ㄧ弭栳箬ㄣ祯篝弪殇孱趄怩汶弭螬骈钺祆蝈趱蝾祜镳骘忮轭翳栳箬鲠祯镦怩汶弭泔祆邈蝈鲥蝮雯┅┅黠螂弪戾玳镱喉犭瀛黠螂弪灬礅溽ㄣ祯篝弪瘐箬ㄦ殪瀛痫箝糸镱姗沆躞翦颦痫轭翦颦扉篝ㄩㄦ轭洵殒灬礅溽豉疱т轵孱趄糸戾┅沆躞翦颟黩轸瀛沆躞翦轰轵孱趄殄沆躞翦后趄遽憝轫恒镯痱弩箝镱戾鲥铋飑戾è疳祜徜黩轸瀛沆躞翦轰轵孱趄殄沆躞翦恒镯痱弩箝镱戾鲥泔眇蝈篌轱瞽戾鲥飑┅黩轸瀛箦聃孱沐疳祜徜姗┅┅┅戾玳镱后翎螋黠螂弪祜镳麒殪沆躞翦蝮滹ㄩㄡ钿沆躞翦蝮戾玳镱瑚矧脲颦聃艴瀛泔躅黠螂弪卑┅戾玳镱横滗觑黠螂弪痫沆躞翦蝮┅换箪邋爱鞍暴冤戾玳镱后麸黠螂弪祜镳麒殪铒ㄥ耢后桴翡秣戾玳镱瑚矧脲颦篝狒躞黠螂弪┅滹箪邋爱鞍暴┅换澡沆躞翦痫轭翦蝮狎腩秣铒鳟箦翩痫箝糸镱痫轭翦蜢轶舡沆躞翦ㄦ殪瀛痫箝糸镱姗ㄤ镬轶ㄣ祯篝弪痫轭翦蝈鲥蝮沆躞翦颦痫轭翦颦扉篝┅黩轸瀛轭翦珏沆躞翦颦痫轭翦姗戾è蝈箫祧邃孱趄殄蟓矧溴颦怡躜蝈箫祧瀛蝈溟蝈泗蟆箫螋孱趄殄＇篝蜷铉换祟秣轭珈镯轸糸铉＼弘妁灬礅溽ㄣ镱汜翦钺翦篝蜷铉钺礤箴徙躜┅┅┅换昨轸犰溟蝈泗矧孱趄殄箝钽翳噤轵孱趄泔铘孱轭篝犷沐栳鲥痫瘐灬翦沆躞翦颦殇忪镡殇铒鳜ㄤ镬轶ㄥ铘蝙蝈箫祧邃孱趄殄蟓矧溴颦怡躜飑瘐箬ㄦ殪瀛痫箝糸镱姗溟颦孱趄痫轭翦颦扉篝黩轸瀛溟颦孱趄孱趄姗换犷牾篝顼痫箝糸镱箦翩痫箝糸镱痫轭翦蜢轶舡躜ㄦ殪瀛痫箝糸镱姗ㄤ镬轶ㄤ轵孱趄痫轭翦蝈鲥蝮溟颦孱趄痫轭翦颦扉篝┅黩轸瀛轭翦珏溟颦孱趄痫轭翦姗换蚤綮轭溴箦翩痫箝糸镱痫轭翦蜢轶舡糸綮ㄦ殪瀛痫箝糸镱姗磲疸狎灬礅溽黩轸瀛轭翦珏ㄣ潋姗箫螋疳轵扉蝈箫祧邃孱趄殄蟓矧溴颦怡躜祜镳骘骝镯忮祜戾铉翳蝈箫祧邃孱趄殄蟓矧溴颦怡躜飑泔祆邈椹＇篝蜷铉弘妁灬礅溽戾è孱趄ㄣ狎┅换祟秣轭珈镯轸糸铉＼ㄣ镱汜翦钺翦篝蜷铉钺礤箴徙孱趄矧糸綮孱趄躜孱趄┅┅┅箦翩痫箝糸镱汨邈塍蹴ㄦ殪瀛痫箝糸镱姗换义黩轸翳桢徜弪鏖翳翳铒鳝腩秣痫箝糸镱螽ㄦ殪瀛痫箝糸镱癌黩轸瀛箦聃孱沐ㄨ遽溴乎蹰ㄩ骒狯秕换郁徕戾栳箬骘蝈痱镤蹉殁殪轸貂殇骒狯秕颟蜥钿镯ㄡ箬辈俯┅侯蹴忮颦镦狎糸沆弩戾铉翳蝈箫祧邃孱趄殄蟓矧溴颦怡躜飑侯蹴忮颦镦沆躞翦蝮戾铉翳蝈盹鲥漉痨殂狒弩祜镳骘孱趄轭蝈箫祧邃孱趄殄蟓矧溴颦怡躜麒孱豉疱孱趄т轵孱趄泔铘孱舂泔祆邈ㄣ祯篝弪殇孱趄┅┅吼矬轸轱瞽痫轭翦蜢轶舡沆躞翦痫箝糸镱痫轭翦蜢轶舡沆躞翦吼矬轸轱瞽痫轭翦蜢轶舡躜痫箝糸镱痫轭翦蜢轶舡躜吼矬轸轱瞽痫轭翦蜢轶舡糸綮痫箝糸镱痫轭翦蜢轶舡糸綮吼矬轸轱瞽汨邈塍蹴痫箝糸镱汨邈塍蹴喉衢瞽疳珏铛礅弪蝈箫祧⒘轭溴梏盱蝈箫祧邃孱趄殄蟓矧溴颦怡躜飑姗┅换蔑眇豸翳汨邈塍蹴犷狃疱钿轸戾è礓礓岛礓刁蹴骈戾秕舡骈戾┅鏖翳镳孱骈戾ㄦ秕舡骈戾洪姝屮轶趔横痧孱洪姝滹弩铒舡屮轶哄蝌矧轰轵邈糸镱猴豸瘐哄戾礤铘豉疱Ж躅箝珙邃怡翦俯黩轸瀛箦聃孱沐礓姗┅ㄦ矧磲铋②赏骈戾黩轸翦篚沣弩箧蹯禊秕舡骈戾┅换ㄣ镱翦铘蟛轫骈戾胡轫泔铘孱趔轫屮犴痨濯换ㄣ镱翦铘蟛轫骈戾胡轫泔铘孱趔轫屮犴痨濯烘灬鲲躜箦戾泗邃骒狯秕颡